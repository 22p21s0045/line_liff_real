<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Document</title>
  </head>
  <body>
    <h1>Hello line liff fix 1</h1>
    <script
      charset="utf-8"
      src="https://static.line-scdn.net/liff/edge/2/sdk.js"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
      /* GET users listing. */

      const queryString = decodeURIComponent(window.location.search).replace(
        "/liff?liff.state=",
        ""
      );
      const params = new URLSearchParams(queryString);
      const id = Number(params.get("id"));
      console.log("Your id is",id);

      
      async function getData() {
        const response = await axios.get(
          `https://sheetdb.io/api/v1/tibezmbrc1l3r`
        );
        console.log(response.data);
        return response.data;
      }
      const data = getData();

      async function main() {
        await liff.init({ liffId: "1657099369-78y1D9eA" });
        await liff.shareTargetPicker([{
          type: "flex",
          altText: "Flex Message",
          contents:{
            type: "bubble",
            hero: {
              type: "image",
              url: `${data[id].image_link}`,
              size: "full",
              aspectRatio: "20:21",
              aspectMode: "cover",
              action: {
                type: "uri",
                uri: `${data[id].image_link}`,
              },
            },
            body: {
              type: "box",
              layout: "vertical",
              contents: [
                {
                  type: "text",
                  text: `${data[id].name}`,
                  weight: "bold",
                  size: "xl",
                },
                {
                  type: "box",
                  layout: "baseline",
                  margin: "md",
                  contents: [
                    {
                      type: "text",
                      text: "โปรโมชั่น ✅",
                      size: "sm",
                      color: "#999999",
                      margin: "md",
                      flex: 0,
                    },
                  ],
                },
                {
                  type: "box",
                  layout: "vertical",
                  margin: "lg",
                  spacing: "sm",
                  contents: [],
                },
              ],
            },
            footer: {
              type: "box",
              layout: "vertical",
              spacing: "sm",
              contents: [
                {
                  type: "button",
                  style: "primary",
                  height: "sm",
                  action: {
                    type: "uri",
                    label: "เเชร์",
                    uri: "https://linecorp.com",
                  },
                },
                {
                  type: "button",
                  style: "link",
                  height: "sm",
                  action: {
                    type: "uri",
                    label: "เพิ่มเติม",
                    uri: "https://linecorp.com",
                  },
                },
                {
                  type: "box",
                  layout: "vertical",
                  contents: [],
                  margin: "sm",
                },
              ],
              flex: 0,
            },
          }
        }
          ,
        ]);
        liff.closeWindow();
      }
      main();
      
      
    </script>
  </body>
</html>
